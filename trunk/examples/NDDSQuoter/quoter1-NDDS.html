<html>

<!-- Assumptions

1) The first step/assignment is just to get a publisher and subscriber
connected. This is fairly easy to do using the nddsgen tool with the
-example parameter.

2) I added modifications needed for the default code generated by nddsgen
for both the publisher and the subscriber. The subscriber by default will
output the data but I thought the student should have some experience with
manipulating and formatting that output.

3) I provided example output but students can format the output however
they want as long as the updates are shown by the publisher and the
subscriber.

4) Modifications to the publisher for future assignments will include
specifying the time between updates on the command line.

5) Will will provide a stock price feed for these assignments. Alternatively,
students could generate stock prices on their own.

6) The student can use nddsgen -example which will generate a compilable
and runnable publisher/subscriber application. However, I didn't say
exactly where changes should be made in the generated code so the
students will need to look through the code and hopefully look at the
DDS calls that need to be made.
-->

<!-- Questions
-->

<title>DDS Stock Quoter Service (Assignment 1)</title>

<BODY text = "#000000"
link="#000fff"
vlink="#ff0f0f"
bgcolor="#ffffff">

<h2>Publish/Subscribe DDS Stock Quoter Service (Assignment 1)</h2>

<H3>Table of Contents</H3>
<UL>
<LI><A HREF="#Overview">Overview</A>
<LI><A HREF="#Building">Building and Running NDDS Applications</A>
<LI><A HREF="#Learning">Learning and Using NDDS</A>
<LI><A HREF="#Concluding">Concluding Remarks</A>
</UL>

<HR>
<H3><A name=Overview>Overview</A></H3>

In this assignment, you will implement a simple Stock Quoter application
using the Data Distribution Service (DDS). The DDS is based on the anonymous
publish and subscribe architecture. In this architecture publishers
anonymously publish
data that has been updated and subscribers can anonymously
receive data that a publisher publishes.  In this application, DDS
subscribers are used to subscribe to a current stock price from a
publisher anonymously in a network. The infrastructure handles getting
the right data from the right publisher to the right subscriber based on
the policies and settings indicated by the application. <P>

<H4>DDS IDL Specification</H4>

The DDS Stock Quoter application will be designed as a publisher/subscriber
pair using the following IDL specification:

<PRE><CODE>
// IDL schema definition for Stock Quoter application.
struct Quoter
{
  double price;
  string symbol;
};
</PRE></CODE>

You can copy the preceding text into an text file with an idl
extension or get a copy of this file <A HREF="Quoter.idl">here</A>. For
the rest of this assignment it is assumed that this file is named
<B>Quoter.idl</B>.<P>

You will use the RTI <EM>nddsgen</EM> tool to translate this
specification into a <EM>publisher</EM> and a <EM>subscriber</EM>
application.  The publisher executable (which you must modify)
will update values to the stocks on a periodic basis.
The subscriber executable (which you will also need to modify) will
then output updates when they are received.<P>

<H4>Subscriber Functionality</H4>

On the subscriber side, you'll need to modify the default output
generated by <EM>nddsgen -example <B>architecture idl_file_name</B></EM>
(e.g., <CODE>nddsgen -example i86Linux2.6gcc3.4.3 Quoter.idl</CODE>). (You
can list
out the different example architectures by passing the help parameter to
nddsgen, i.e., <CODE>nddsgen -help</CODE>.)
By default, <EM>nddsgen</EM> (with the <EM>-example <B>architecture</B></EM>
option) generates code that will output the data received along with a
makefile to build the object files and executables.
You will need to modify the format of the output.<P>

There are different ways to be notified of updates according to the
<A HREF="http://www.omg.org/cgi-bin/doc?formal/05-12-04">DDS specification</A>
but <EM>nddsgen -example</EM> will create a data reader
listener and implement the
<CODE>on_data_available</CODE> method to process incoming
data updates. The easiest place for you to modify the output is in this
method.<P>

The generated code takes two command line parameters. The first is the
domain id (which is a number and defaults to 0). The second is the number of
iterations to check for updates (which also defaults to 0 indicating an
infinite loop).
<P>

<B>NOTE: The domain ids for the subscriber and the publisher must match.
Otherwise, there will be no data flowing between the two. By default,
the domain ids used will both be 0.</B><P>

If anything fails to work properly the subscriber should simply print out
the appropriate exception and exit with a return status of 1.  If
everything works correctly, the subscriber should exit with a return
status of 0 when the correct number of iterations have been executed. <P>

<H4>Publisher Functionality</H4> 

When the client starts up, it will periodically update and publish
stock prices. You will need to modify the generated code so that more than
one stock (i.e., <EM>instance</EM> for this example) is published. (The
generated code only has one instance of data.) You will need to modify the
generated code to set the symbols of the stocks as well as update
the stock prices. You will also need to modify the code to display the
values when they are updated. This will suffice as a base verification
of data exchange between the publisher and subscriber.<P>

The generated code takes two parameters. The first is the domain id (which
is a number and defaults to 0). The second is the number of iterations to
publish updates (which also defaults to 0 indicating an infinite loop).
<P>

<B>NOTE: The domain ids for the subscriber and the publisher must match.
Otherwise, there will be no data flowing between the two. By default,
the domain ids used will both be 0.</B><P>

If anything fails to work properly the publisher should simply print out
the appropriate exception and exit with a return status of 1.  If
everything works correctly, the publisher should exit with a return
status of 0 when the correct number of iterations have been executed.<P>

<HR>
<H3><A name=Building>Building and Running NDDS Applications</A></H3>

When using nddsgen with the -example command line option, a makefile is
generated for you on Linux (e.g.,
<EM>makefile_Quoter_i86Linux2.6gcc3.4.3</EM>) and a solution is generated
for you for Windows (e.g., <EM>Quoter_i86Win32VS2003.sln</EM>).
You can use this makefile or solution to generate the object files and
executables (e.g., <CODE>make -f makefile_Quoter_i86Linux2.6gcc3.4.3</CODE>
for Linux or double click the <EM>i86Win32VS2003</EM> solution on Windows).
The makefile or solution will create
an <CODE>objs/</CODE><EM><B>architecture</B></EM> subdirectory (e.g.,
<CODE>objs/i86Linux2.6gcc3.4.3</CODE>) and put
the object files and executables in there.<P>

The executables that are built are stand-alone and can be run from
anywhere. Also, the order in which the executables are invoked is not
important although by default the subscriber will only receive published
updates since the time it was started. Later, we'll see how to change this so
the subscriber can receive updates published before the subscriber started.<P>

<H4>Example Output</H4>

The following is an example of what your output might look like.<P>

Example output for the supplier: <P>

<PRE><CODE>
$ Quoter_subscriber
Quoter subscriber sleeping for 4 sec...
Quoter subscriber sleeping for 4 sec...
Stock price for IBM is 100
Stock price for MSFT is 10
Quoter subscriber sleeping for 4 sec...
Stock price for IBM is 200
Stock price for MSFT is 20
Quoter subscriber sleeping for 4 sec...
Stock price for IBM is 300
Stock price for MSFT is 30
Quoter subscriber sleeping for 4 sec...
Stock price for IBM is 400
Stock price for MSFT is 40
Quoter subscriber sleeping for 4 sec...
Stock price for IBM is 500
Stock price for MSFT is 50
Quoter subscriber sleeping for 4 sec...
Stock price for IBM is 600
Stock price for MSFT is 60
Quoter subscriber sleeping for 4 sec...
Stock price for IBM is 700
Stock price for MSFT is 70
Quoter subscriber sleeping for 4 sec...

</PRE></CODE>

Example output for the publisher: <P>

<PRE><CODE>
$ Quoter_publisher
Writing Quoter, count 0
Stock IBM at 0
Stock MSFT at 0
Writing Quoter, count 1
Stock IBM at 100
Stock MSFT at 10
Writing Quoter, count 2
Stock IBM at 200
Stock MSFT at 20
Writing Quoter, count 3
Stock IBM at 300
Stock MSFT at 30
Writing Quoter, count 4
Stock IBM at 400
Stock MSFT at 40
Writing Quoter, count 5
Stock IBM at 500
Stock MSFT at 50
Writing Quoter, count 6
Stock IBM at 600
Stock MSFT at 60
Writing Quoter, count 7
Stock IBM at 700
Stock MSFT at 70

</PRE></CODE>

<HR>
<H3><A name=Learning>Learning and Using DDS</A></H3>

We will be using <A HREF="http://rti.com">Real-Time Innovations</A>' <A
HREF="http://www.rti.com/products/data_distribution/index.html">NDDS</A>
Data Distribution Service (DDS) implementation.
Here is a link to the <A HREF=
"http://www.dre.vanderbilt.edu/~mxiong/ndds41c-i86Linux2.6gcc3.4.3.tar.gz">
NDDS Linux distribution</A> and here is a link to the <A
HREF="http://www.dre.vanderbilt.edu/~mxiong/ndds41c-i86Win32VS2003.zip">
NDDS Windows distribution</A>. The
<A HREF="http://www.dre.vanderbilt.edu/~mxiong/RTI_DDS_GettingStarted.pdf">
Getting Started document</A> will help you in setting up your environment for
NDDS.
The <A HREF="http://www.dre.vanderbilt.edu/~mxiong/RTI_DDS_UsersManual.pdf">
NDDS User's Manual</A> outlines the API for developing NDDS applications.
These documents are available in the distributions under the doc
subdirectory.

<HR>
<H3><A name=Concluding>Concluding Remarks</A></H3>

This first DDS assignment is very simple.  However, it will
illustrate the basic skills required to become adept at using DDS
publish/subscribe middleware to developed distributed applications.
Subsequent assignments will build on this assignment, so make sure you
get it working correctly. <P>

<HR><P>
Back to <A HREF="http://www.cs.wustl.edu/~schmidt/cs395/">CS 395</A> home page.
</html>
